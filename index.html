<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>📷 Přidat produkt</title>
    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="container mx-auto max-w-md p-6">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">📷 Přidat produkt</h1>
            <div id="status" class="status mt-3 text-lg font-semibold text-blue-800 bg-blue-100 p-4 rounded-lg shadow-md border border-blue-300">👉 ZAČNI VÝBĚREM OBCHODU</div>
            <div id="today-product-count" class="mt-2 text-sm text-gray-600">Dnes přidáno: 0 produktů</div>
        </header>

        <!-- Krok 0: Výběr obchodu -->
        <section id="shop-selection" class="step bg-white p-6 rounded-xl shadow-lg mb-6 relative">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">0️⃣ Vyber obchod</h2>
            <button id="shop-zvole" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg mb-3 flex items-center justify-center text-lg">Antik Zvole [Z]</button>
            <button id="shop-mora" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg flex items-center justify-center text-lg">Antik Mora [M]</button>
            <div class="absolute top-2 right-2 flex space-x-2">
                <button class="nav-btn next-btn" data-step="0">➡️</button>
            </div>
        </section>

        <!-- Krok 1: Focení -->
        <section id="photo-section" class="step bg-white p-6 rounded-xl shadow-lg mb-6 hidden relative">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">1️⃣ Nafoť fotky</h2>
            <button id="take-photo-btn" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg flex items-center justify-center text-lg">
                📸 Nafoť fotku
            </button>
            <p id="photo-count" class="text-center mt-4 text-gray-600 text-sm">Nafoceno: <span>0/3</span> 🎞️</p>
            <input type="file" id="photo-input" accept="image/*" capture="camera" class="hidden">
            <div class="absolute top-2 right-2 flex space-x-2">
                <button class="nav-btn prev-btn" data-step="1">⬅️</button>
                <button class="nav-btn next-btn" data-step="1">➡️</button>
            </div>
        </section>

        <!-- Krok 2: Detaily produktu -->
        <section id="product-details" class="step bg-white p-6 rounded-xl shadow-lg mb-6 hidden relative">
            <h2 class="text-xl font-semibold text-gray-700 mb-6">2️⃣ Vyplň detaily</h2>
            <div class="mb-6">
                <label for="product-name" class="block text-sm font-medium text-gray-700 mb-2">Název produktu:</label>
                <input type="text" id="product-name" placeholder="📦 Název produktu" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div class="mb-6">
                <label for="product-price" class="block text-sm font-medium text-gray-700 mb-2">Cena (Kč):</label>
                <input type="number" id="product-price" placeholder="💰 Cena (Kč)" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div class="mb-6">
                <label for="product-location" class="block text-sm font-medium text-gray-700 mb-2">Umístění (nepovinné):</label>
                <input type="text" id="product-location" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm" placeholder="Zadej umístění">
                <div id="location-history" class="mt-2 text-sm text-gray-500"></div>
            </div>
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Kategorie:</label>
                <button id="category-btn" class="btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 rounded-lg flex items-center justify-center text-sm">🔍 Vybrat kategorii</button>
                <input type="hidden" id="category-id">
            </div>
            <div class="mb-6">
                <label for="shipping-method" class="block text-sm font-medium text-gray-700 mb-2">Vyber způsob dopravy:</label>
                <select id="shipping-method" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                    <option value="2424163" selected>ZÁSILKOVNA (2424163)</option>
                    <option value="2426697">DPD (2426697)</option>
                    <option value="2435308">TOPTRANS (2435308)</option>
                    <option value="2435307">OSOBNĚ (2435307)</option>
                </select>
            </div>
            <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2.5 hidden">
                <div id="progress" class="bg-green-500 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <button onclick="addProduct()" class="btn w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg mt-6 flex items-center justify-center text-lg">
                ✅ Přidat produkt
            </button>
            <div class="absolute top-2 right-2 flex space-x-2">
                <button class="nav-btn prev-btn" data-step="2">⬅️</button>
                <button class="nav-btn next-btn" data-step="2">➡️</button>
            </div>
        </section>

        <!-- Krok 3: Dokončení -->
        <section id="finish-section" class="step bg-white p-6 rounded-xl shadow-lg hidden relative">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">3️⃣ Dokonči</h2>
            <button id="add-another-btn" onclick="addAnotherProduct()" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg mb-3 flex items-center justify-center text-lg">
                ➕ Přidat další produkt
            </button>
            <button id="finish-btn" onclick="finish()" class="btn w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg mb-3 flex items-center justify-center text-lg">
                🚀 Odeslat přes WhatsApp
            </button>
            <button id="reset-btn" onclick="resetStorage()" class="btn w-full bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg flex items-center justify-center text-lg">
                🗑️ Obnovit data
            </button>
            <div id="saved-products" class="mt-4 text-gray-600 text-sm"></div>
            <div class="absolute top-2 right-2 flex space-x-2">
                <button class="nav-btn prev-btn" data-step="3">⬅️</button>
            </div>
        </section>

        <div id="confirm-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden">
            <div class="bg-white p-6 rounded shadow-lg">
                <p class="text-lg mb-4">Opravdu?</p>
                <div class="flex justify-end gap-4">
                    <button id="confirm-yes" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">ANO</button>
                    <button id="confirm-no" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">NE</button>
                </div>
            </div>
        </div>

        <!-- Vlastní dialog pro opuštění stránky -->
        <div id="exit-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden">
            <div class="bg-white p-6 rounded-xl shadow-lg text-center max-w-sm w-full">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Vymazal jsi data, když jsi skončil?</h2>
                <p class="text-gray-600 mb-6">Pokud ne, můžeš to udělat teď.</p>
                <button id="delete-data-btn" class="btn bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg mb-3">🗑️ Vymazat data</button>
                <button id="close-modal-btn" class="btn bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg">Pokračovat bez mazání</button>
            </div>
        </div>

        <!-- Modální okno pro výběr kategorie -->
        <div id="category-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden">
            <div class="bg-white p-6 rounded-xl shadow-lg w-full max-w-md">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Vyber kategorii</h2>
                <input type="text" id="category-search" placeholder="🔍 Hledej kategorii" class="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                <div id="category-list" class="max-h-64 overflow-y-auto border border-gray-200 rounded-lg"></div>
                <button id="category-close-btn" class="btn w-full bg-gray-500 hover:bg-gray-600 text-white py-3 mt-4 rounded-lg">Zavřít</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
